<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    
</body>
</html>
<script src="./Promise.class.js"></script>
<script>
    const p = new Promise((resolve, reject) => {
       setTimeout(() => {
            reject(1)
       }, 100)
    })

    p.then(
        value => { 
            console.log('onResolved1', value) 
            return 3 
        },
        reason => { 
            console.log('onRejected1', reason)
            return new Promise((resolve, reject) => reject(5))
         }
    ).then(
        value => { console.log('onResolved2', value) },
        reason => { 
            console.log('onRejected2', reason) 
            throw 5
        }
    ).catch(reason => {
        console.log("Error", reason)
        return new Promise(() => {}) // 中断Promise链
    })
    .then(
        value => { console.log('onResolved2', value) },
        reason => { 
            console.log('onRejected2', reason) 
            throw 5
        }
    )
    
    const p1 = Promise.resolve(1)
    p1.then(value => console.log('p1', value))

    const p2 = Promise.resolve(Promise.resolve(2))
    p2.then(value => console.log('p2', value))

    const p3 = Promise.resolve(Promise.reject(3))
    p3.catch(value => console.log('p3', value))

    const p4 = new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve(4)
        }, 1000)
    })
    
    // const pAll = Promise.all([p1, p2, p3])
    // pAll.then(
    //     values => {
    //         console.log("allll", values)
    //     },
    //     reason => {
    //         console.log("allll reject", reason)
    //     }
    // )

    const pRace = Promise.race([p4, p3, p2, p1])
    pRace.then(
        values => {
            console.log("pRace", values)
        },
        reason => {
            console.log("pRace reject", reason)
        }
    )

    const pdelay = Promise.resolveDelay(1, 2000)
    const pdelay2 = Promise.rejectDelay(2, 3000)

    pdelay.then(
        values => {
            console.log("pdelay", values)
        },
        reason => {
            console.log("pdelay reject", reason)
        }
    )

    pdelay2.then(
        values => {
            console.log("pdelay", values)
        },
        reason => {
            console.log("pdelay reject", reason)
        }
    )

</script>